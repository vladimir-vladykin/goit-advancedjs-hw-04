{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const HITS_PER_PAGE = 15;\n\nconst pixabayBaseSearchParams = {\n  key: '49592968-cbe332f50941125abd5725851',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: HITS_PER_PAGE,\n};\n\nexport async function loadImages(searchQuery, page) {\n  const searchParams = new URLSearchParams(pixabayBaseSearchParams);\n  searchParams.append('q', searchQuery);\n  searchParams.append('page', page);\n\n  const url = `https://pixabay.com/api/?${searchParams}`;\n  const response = await axios.get(url);\n  return {\n    images: response.data.hits,\n    totalImageCount: response.data.totalHits,\n  };\n}\n","export function displayLoadMoreButton(layout) {\n  layout.innerHTML = '<button class=\"load-more-button\">Load more</button>';\n}\n\nexport function clearLayout(anyLayout) {\n  anyLayout.innerHTML = '';\n}\n\nexport function renderLoader(layout) {\n  layout.innerHTML = `<span class=\"loader\"></span>`;\n}\n\nexport function renderImages(galleryList, images) {\n  const markup = images\n    .map(image => {\n      return createImageMarkup(image);\n    })\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction createImageMarkup(image) {\n  return `\n        <li class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\">\n              <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n              <ul class=\"image-metadata-list\">\n                  <li class=\"image-metadata-item\">\n                      <p class=\"image-metadata-item-title\">Likes</p>\n                      <p class=\"image-metadata-item-value\">${image.likes}</p>\n                  </li>\n                  <li class=\"image-metadata-item\">\n                      <p class=\"image-metadata-item-title\">Views</p>\n                      <p class=\"image-metadata-item-value\">${image.views}</p>\n                  </li>\n                  <li class=\"image-metadata-item\">\n                      <p class=\"image-metadata-item-title\">Comments</p>\n                      <p class=\"image-metadata-item-value\">${image.comments}</p>\n                  </li>\n                  <li class=\"image-metadata-item\">\n                      <p class=\"image-metadata-item-title\">Downloads</p>\n                      <p class=\"image-metadata-item-value\">${image.downloads}</p>\n                  </li>\n              </ul>\n            </a>\n        </li>\n    `;\n}\n","import { loadImages, HITS_PER_PAGE } from './js/pixabay-api.js';\nimport {\n  renderImages,\n  clearLayout,\n  renderLoader,\n  displayLoadMoreButton,\n} from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentPage = 1;\nlet latestSearchQuery = '';\nconst searchForm = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\nconst loadingLayout = document.querySelector('.loading_layout');\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n\n  latestSearchQuery = event.currentTarget.elements.search.value.trim();\n\n  if (latestSearchQuery === '') {\n    showErrorMessage('Empty search query, please enter something');\n    return;\n  }\n\n  startLoadingImages(latestSearchQuery);\n});\n\n// setup lib for image details\nconst lighboxInstance = new SimpleLightbox('.gallery a', {\n  disableScroll: false,\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\nfunction startLoadingImages(searchQuery) {\n  currentPage = 1;\n  clearLayout(galleryList);\n  renderLoader(loadingLayout);\n\n  loadImages(searchQuery, currentPage)\n    .then(imageData => {\n      if (imageData.images.length === 0) {\n        showErrorMessage(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n        clearLayout(loadingLayout);\n        return;\n      }\n\n      updateLayoutWithNewImages(imageData);\n    })\n    .catch(error => {\n      clearLayout(loadingLayout);\n      showErrorMessage(error.message);\n    });\n}\n\nfunction continueLoadingImages() {\n  currentPage++;\n  renderLoader(loadingLayout);\n\n  loadImages(latestSearchQuery, currentPage)\n    .then(imageData => {\n      updateLayoutWithNewImages(imageData);\n      smoothScrollDownIfPossible();\n    })\n    .catch(error => {\n      showErrorMessage(error.message);\n\n      // display load more button again in case we failed to load this part\n      updateLoadMoreButton(true);\n    });\n}\n\nfunction updateLayoutWithNewImages({ images, totalImageCount }) {\n  const loadedImagesCount = currentPage * HITS_PER_PAGE;\n\n  const stillMoreImagesToLoad = loadedImagesCount < totalImageCount;\n  renderImages(galleryList, images);\n  updateLoadMoreButton(stillMoreImagesToLoad);\n  lighboxInstance.refresh();\n\n  if (!stillMoreImagesToLoad) {\n    showErrorMessage(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  }\n}\n\nfunction updateLoadMoreButton(shouldButtonBeAvailable) {\n  if (shouldButtonBeAvailable) {\n    displayLoadMoreButton(loadingLayout);\n    const loadMoreButton = document.querySelector('.load-more-button');\n    loadMoreButton.addEventListener('click', event => {\n      continueLoadingImages();\n    });\n  } else {\n    clearLayout(loadingLayout);\n  }\n}\n\nfunction smoothScrollDownIfPossible() {\n  const anyCard = document.querySelector('.gallery-item');\n  const cardHeight = anyCard.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showErrorMessage(message) {\n  iziToast.show({\n    message,\n    messageColor: 'white',\n    position: 'topRight',\n    backgroundColor: '#ef4040',\n  });\n}\n"],"names":["HITS_PER_PAGE","pixabayBaseSearchParams","loadImages","searchQuery","page","searchParams","url","response","axios","displayLoadMoreButton","layout","clearLayout","anyLayout","renderLoader","renderImages","galleryList","images","markup","image","createImageMarkup","currentPage","latestSearchQuery","searchForm","loadingLayout","event","showErrorMessage","startLoadingImages","lighboxInstance","SimpleLightbox","imageData","updateLayoutWithNewImages","error","continueLoadingImages","smoothScrollDownIfPossible","updateLoadMoreButton","totalImageCount","stillMoreImagesToLoad","shouldButtonBeAvailable","cardHeight","message","iziToast"],"mappings":"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"}